# ============================================================
# VERO LANGUAGE - COMPLETE SYNTAX REFERENCE
# ============================================================
# This file demonstrates ALL valid Vero syntax constructs
# for Page Objects, PageActions, Features, Scenarios, and Actions.
# ============================================================

# ============================================================
# SECTION 1: PAGE OBJECT MODEL (Pages)
# ============================================================
# Pages define UI element selectors and member variables ONLY.
# All actions belong in PAGEACTIONS classes.

PAGE LoginPage {
    # --------------------------------------------------------
    # FIELDS: Define UI element selectors (PROTECTED)
    # Syntax: FIELD name = "selector-text"
    # --------------------------------------------------------

    FIELD usernameInput = "Username"
    FIELD passwordInput = "Password"
    FIELD loginButton = "Login"
    FIELD rememberMeCheckbox = "Remember me"
    FIELD forgotPasswordLink = "Forgot password?"
    FIELD errorMessage = "Invalid credentials"
    FIELD welcomeMessage = "Welcome"
    FIELD logo = "Company Logo"

    # --------------------------------------------------------
    # MEMBER VARIABLES: Define reusable values within the page
    # Types: TEXT, NUMBER, FLAG (boolean)
    # --------------------------------------------------------

    TEXT defaultUsername = "admin"
    TEXT defaultPassword = "password123"
    NUMBER maxLoginAttempts = 3
    FLAG isRememberMeEnabled = TRUE
}

PAGE DashboardPage {
    FIELD welcomeMessage = "Welcome"
    FIELD userMenu = "User Menu"
    FIELD logoutButton = "Logout"
    FIELD settingsLink = "Settings"
    FIELD notificationBell = "Notifications"
    FIELD searchBox = "Search"
    FIELD sidebarToggle = "Toggle Sidebar"

    TEXT pageTitle = "Dashboard"
    NUMBER defaultTimeout = 5000
}

PAGE ProductPage {
    FIELD productName = "Product Name"
    FIELD productPrice = "Price"
    FIELD addToCartButton = "Add to Cart"
    FIELD quantityInput = "Quantity"
    FIELD colorDropdown = "Color"
    FIELD sizeDropdown = "Size"
    FIELD productImage = "Product Image"
    FIELD reviewsSection = "Reviews"

    NUMBER defaultQuantity = 1
    TEXT defaultColor = "Black"
    TEXT defaultSize = "Medium"
}

# ============================================================
# SECTION 2: PAGEACTIONS (Public Interface to Pages)
# ============================================================
# PageActions encapsulate ALL interactions with Page fields.
# Features can ONLY interact with Pages through PageActions.

PAGEACTIONS LoginPageActions FOR LoginPage {
    # --------------------------------------------------------
    # SETTERS: Input data into fields
    # --------------------------------------------------------

    enterUsername WITH value {
        FILL usernameInput WITH value
    }

    enterPassword WITH value {
        FILL passwordInput WITH value
    }

    # --------------------------------------------------------
    # ACTIONS: Perform interactions
    # --------------------------------------------------------

    clickLogin {
        CLICK loginButton
    }

    clickForgotPassword {
        CLICK forgotPasswordLink
    }

    checkRememberMe {
        CHECK rememberMeCheckbox
    }

    uncheckRememberMe {
        UNCHECK rememberMeCheckbox
    }

    # --------------------------------------------------------
    # COMPOSITE ACTIONS: Multi-step workflows
    # --------------------------------------------------------

    login WITH username, password {
        FILL usernameInput WITH username
        FILL passwordInput WITH password
        CLICK loginButton
    }

    loginWithDefaults {
        FILL usernameInput WITH defaultUsername
        FILL passwordInput WITH defaultPassword
        CLICK loginButton
    }

    # --------------------------------------------------------
    # GETTERS: Return data for assertions in scenarios
    # Use RETURNS to specify return type: TEXT, NUMBER, FLAG
    # --------------------------------------------------------

    getErrorText RETURNS TEXT {
        RETURN TEXT OF errorMessage
    }

    getWelcomeText RETURNS TEXT {
        RETURN TEXT OF welcomeMessage
    }

    isErrorVisible RETURNS FLAG {
        RETURN VISIBLE OF errorMessage
    }

    isWelcomeVisible RETURNS FLAG {
        RETURN VISIBLE OF welcomeMessage
    }

    isLoginButtonVisible RETURNS FLAG {
        RETURN VISIBLE OF loginButton
    }

    isLoginButtonEnabled RETURNS FLAG {
        RETURN ENABLED OF loginButton
    }

    isRememberMeChecked RETURNS FLAG {
        RETURN CHECKED OF rememberMeCheckbox
    }

    # --------------------------------------------------------
    # WAITERS: Setup helpers
    # --------------------------------------------------------

    awaitLoginPage {
        WAIT FOR usernameInput
    }
}

PAGEACTIONS DashboardPageActions FOR DashboardPage {
    # Setters
    enterSearchQuery WITH query {
        FILL searchBox WITH query
    }

    # Actions
    clickUserMenu {
        CLICK userMenu
    }

    clickLogout {
        CLICK logoutButton
    }

    clickSettings {
        CLICK settingsLink
    }

    clickNotifications {
        CLICK notificationBell
    }

    toggleSidebar {
        CLICK sidebarToggle
    }

    # Composite Actions
    logout {
        CLICK userMenu
        CLICK logoutButton
    }

    search WITH query {
        FILL searchBox WITH query
        PRESS "Enter"
    }

    # Getters
    getWelcomeText RETURNS TEXT {
        RETURN TEXT OF welcomeMessage
    }

    isWelcomeVisible RETURNS FLAG {
        RETURN VISIBLE OF welcomeMessage
    }

    # Waiters
    awaitDashboard {
        WAIT FOR welcomeMessage
    }
}

PAGEACTIONS ProductPageActions FOR ProductPage {
    # Setters
    enterQuantity WITH qty {
        FILL quantityInput WITH qty
    }

    selectColor WITH color {
        FILL colorDropdown WITH color
    }

    selectSize WITH size {
        FILL sizeDropdown WITH size
    }

    # Actions
    clickAddToCart {
        CLICK addToCartButton
    }

    hoverProductImage {
        HOVER productImage
    }

    # Composite Actions
    addToCart {
        CLICK addToCartButton
    }

    addToCartWithQuantity WITH qty {
        FILL quantityInput WITH qty
        CLICK addToCartButton
    }

    addToCartWithOptions WITH qty, color, size {
        FILL quantityInput WITH qty
        FILL colorDropdown WITH color
        FILL sizeDropdown WITH size
        CLICK addToCartButton
    }

    # Getters
    getProductName RETURNS TEXT {
        RETURN TEXT OF productName
    }

    getProductPrice RETURNS TEXT {
        RETURN TEXT OF productPrice
    }

    getQuantityValue RETURNS TEXT {
        RETURN VALUE OF quantityInput
    }

    getReviewCount RETURNS NUMBER {
        RETURN COUNT OF reviewsSection
    }

    isAddToCartEnabled RETURNS FLAG {
        RETURN ENABLED OF addToCartButton
    }
}

# ============================================================
# SECTION 3: FIXTURES (Test Setup/Teardown)
# ============================================================

FIXTURE authenticatedUser {
    SCOPE test

    OPTION userRole DEFAULT "user"
    OPTION timeout DEFAULT 30000

    SETUP {
        OPEN "https://example.com/login"
        PERFORM LoginPageActions.login WITH "testuser", "testpass"
        WAIT 2 SECONDS
    }

    TEARDOWN {
        PERFORM DashboardPageActions.logout
    }
}

FIXTURE cleanDatabase {
    SCOPE worker
    AUTO

    SETUP {
        LOG "Setting up test database..."
    }

    TEARDOWN {
        LOG "Cleaning up test database..."
    }
}

# ============================================================
# SECTION 4: FEATURES AND SCENARIOS
# ============================================================
# Features USE PageActions, NOT Pages directly.
# All assertions belong in SCENARIOS, not in PageActions.

@serial
FEATURE UserAuthentication {

    WITH FIXTURE cleanDatabase

    BEFORE ALL {
        LOG "Starting User Authentication tests"
        OPEN "https://example.com"
    }

    BEFORE EACH {
        OPEN "https://example.com/login"
        PERFORM LoginPageActions.awaitLoginPage
    }

    AFTER EACH {
        TAKE SCREENSHOT
    }

    AFTER ALL {
        LOG "Completed User Authentication tests"
    }

    SCENARIO UserCanLoginWithValidCredentials @smoke @critical {
        # Use PageActions setters to enter data
        PERFORM LoginPageActions.enterUsername WITH "validuser"
        PERFORM LoginPageActions.enterPassword WITH "validpass123"

        # Use PageActions action to click
        PERFORM LoginPageActions.clickLogin

        # Wait for page transition
        WAIT 2 SECONDS
        PERFORM DashboardPageActions.awaitDashboard

        # ASSERTIONS IN SCENARIO using getters
        FLAG isWelcome = PERFORM DashboardPageActions.isWelcomeVisible
        VERIFY isWelcome IS TRUE

        FLAG hasError = PERFORM LoginPageActions.isErrorVisible
        VERIFY hasError IS NOT TRUE
    }

    @slow
    SCENARIO UserSeesErrorWithInvalidCredentials @negative {
        # Use composite action
        PERFORM LoginPageActions.login WITH "invaliduser", "wrongpassword"

        WAIT 500 MILLISECONDS

        # Assertions using getters
        FLAG hasError = PERFORM LoginPageActions.isErrorVisible
        VERIFY hasError IS TRUE

        TEXT errorText = PERFORM LoginPageActions.getErrorText
        VERIFY errorText CONTAINS "Invalid"

        FLAG isWelcome = PERFORM DashboardPageActions.isWelcomeVisible
        VERIFY isWelcome IS NOT TRUE
    }

    @skip
    SCENARIO RememberMeFunctionality @regression {
        PERFORM LoginPageActions.enterUsername WITH "testuser"
        PERFORM LoginPageActions.enterPassword WITH "testpass"

        # Use PageActions to check checkbox
        PERFORM LoginPageActions.checkRememberMe

        PERFORM LoginPageActions.clickLogin
        WAIT 2 SECONDS

        # Assert using getter
        FLAG isChecked = PERFORM LoginPageActions.isRememberMeChecked
        VERIFY isChecked IS TRUE
    }

    SCENARIO UserCanUseCompositeActions {
        # PERFORM action: Call PageActions composite action
        PERFORM LoginPageActions.login WITH "testuser", "testpass"

        WAIT 2 SECONDS
        PERFORM DashboardPageActions.awaitDashboard

        FLAG isWelcome = PERFORM DashboardPageActions.isWelcomeVisible
        VERIFY isWelcome IS TRUE

        PERFORM DashboardPageActions.logout

        PERFORM LoginPageActions.awaitLoginPage
        FLAG isLoginVisible = PERFORM LoginPageActions.isLoginButtonVisible
        VERIFY isLoginVisible IS TRUE
    }
}

FEATURE ProductCatalog {

    BEFORE EACH {
        OPEN "https://example.com/products"
    }

    SCENARIO UserCanAddProductToCart @e2e {
        # Use PageActions for all interactions
        PERFORM ProductPageActions.hoverProductImage

        PERFORM ProductPageActions.selectColor WITH "Blue"
        PERFORM ProductPageActions.selectSize WITH "Large"

        PERFORM ProductPageActions.addToCartWithQuantity WITH "2"

        # Assert using getter
        TEXT productName = PERFORM ProductPageActions.getProductName
        VERIFY productName CONTAINS "Sample Product"
    }

    SCENARIO UserCanSearchForProducts @searchtest {
        PERFORM DashboardPageActions.search WITH "laptop"

        WAIT 1 SECONDS

        # URL and Title assertions stay in scenario
        VERIFY URL CONTAINS "search=laptop"
        VERIFY TITLE CONTAINS "Search Results"
    }

    SCENARIO ProductPageValidation @validation {
        # Use getters for all data retrieval, assertions in scenario
        NUMBER reviewCount = PERFORM ProductPageActions.getReviewCount
        VERIFY reviewCount IS 5

        TEXT qty = PERFORM ProductPageActions.getQuantityValue
        VERIFY qty EQUAL "1"

        FLAG canAddToCart = PERFORM ProductPageActions.isAddToCartEnabled
        VERIFY canAddToCart IS TRUE
    }
}

FEATURE AdvancedActions {

    SCENARIO DemonstratesAllClickVariants @clicktest {
        # Standard click via PageActions
        PERFORM LoginPageActions.clickLogin

        # Direct clicks still allowed for simple cases
        CLICK "Submit Button"

        # Right-click (context menu)
        RIGHT CLICK "Context Menu Target"

        # Double-click
        DOUBLE CLICK "Editable Cell"

        # Force click (bypasses visibility checks)
        FORCE CLICK "Hidden Element"
    }

    SCENARIO DemonstratesDragAndDrop @dragtest {
        # Drag element to another element
        DRAG "Draggable Item" TO "Drop Zone"

        # Drag element to coordinates
        DRAG "Movable Element" TO X 300 Y 400
    }

    SCENARIO DemonstratesKeyboardActions @keyboard {
        PERFORM LoginPageActions.enterUsername WITH "test"

        # PRESS action: Keyboard keys
        PRESS "Tab"
        PRESS "Enter"
        PRESS "Escape"
        PRESS "Control+A"
        PRESS "Shift+Tab"
    }

    SCENARIO DemonstratesScreenshots @screenshottest {
        # Full page screenshot
        TAKE SCREENSHOT

        # Screenshot with custom name
        TAKE SCREENSHOT "before-login"

        LOG "Screenshots captured"
    }

    SCENARIO DemonstratesFileUpload @filetest {
        # Single file upload
        UPLOAD "test-file.pdf" TO "#fileInput"

        # Multiple file upload
        UPLOAD "image1.jpg", "image2.jpg", "image3.jpg" TO "#multiUpload"
    }

    SCENARIO DemonstratesWaitVariations @waitest {
        # Wait fixed seconds
        WAIT 2 SECONDS

        # Wait milliseconds
        WAIT 500 MILLISECONDS

        LOG "Wait actions completed"
    }

    SCENARIO DemonstratesLogging @logtest {
        LOG "Starting test execution"
        LOG "Current user: testuser"
        LOG "Test environment: staging"
    }

    SCENARIO DemonstratesPageRefresh @navtest {
        OPEN "https://example.com/dashboard"
        WAIT 1 SECONDS

        # REFRESH action
        REFRESH

        WAIT 2 SECONDS

        FLAG isWelcome = PERFORM DashboardPageActions.isWelcomeVisible
        VERIFY isWelcome IS TRUE
    }
}

FEATURE DataDrivenTesting {

    SCENARIO TestWithLoadedData @datatest {
        # LOAD: Load data from a data table
        LOAD testUser FROM "Users" WHERE status = "active"
        LOAD productData FROM "Products" WHERE category = "electronics"

        # Use loaded data with FOR EACH loop
        FOR EACH user IN testUser {
            PERFORM LoginPageActions.login WITH user.username, user.password

            FLAG isWelcome = PERFORM DashboardPageActions.isWelcomeVisible
            VERIFY isWelcome IS TRUE

            PERFORM DashboardPageActions.logout
        }
    }

    SCENARIO TestWithEnvironmentVariables @envtest {
        # Environment variables use {{variableName}} syntax
        PERFORM LoginPageActions.enterUsername WITH {{TEST_USERNAME}}
        PERFORM LoginPageActions.enterPassword WITH {{TEST_PASSWORD}}
        PERFORM LoginPageActions.clickLogin

        OPEN {{BASE_URL}}
    }
}

FEATURE VerificationExamples {

    SCENARIO AllVerifyVariations @verifytest {
        # Visibility assertions using getters
        FLAG isLoginVisible = PERFORM LoginPageActions.isLoginButtonVisible
        VERIFY isLoginVisible IS TRUE

        FLAG hasError = PERFORM LoginPageActions.isErrorVisible
        VERIFY hasError IS NOT TRUE

        # Enabled state using getter
        FLAG isEnabled = PERFORM LoginPageActions.isLoginButtonEnabled
        VERIFY isEnabled IS TRUE

        # Checkbox state using getter
        FLAG isChecked = PERFORM LoginPageActions.isRememberMeChecked
        VERIFY isChecked IS NOT TRUE

        # URL assertions (direct in scenario)
        VERIFY URL CONTAINS "/login"
        VERIFY URL EQUAL "https://example.com/login"
        VERIFY URL MATCHES "/login.*"

        # Title assertions (direct in scenario)
        VERIFY TITLE CONTAINS "Login"
        VERIFY TITLE EQUAL "Login - Example App"

        # Text content using getter
        TEXT errorText = PERFORM LoginPageActions.getErrorText
        VERIFY errorText CONTAINS "Invalid"

        # Direct text verification (still allowed)
        VERIFY "Welcome" IS VISIBLE
        VERIFY "Error" IS NOT VISIBLE
    }
}

# ============================================================
# SECTION 5: FEATURE WITH ALL ANNOTATIONS
# ============================================================

@skip
FEATURE AnnotationDemo {

    @skip
    SCENARIO SkippedTest {
        LOG "This test is skipped"
    }

    @only
    SCENARIO OnlyThisTestRuns {
        LOG "This is the only test that runs"
    }

    @slow
    SCENARIO SlowTestWithExtendedTimeout {
        LOG "This test has extended timeout"
        WAIT 10 SECONDS
    }

    @fixme
    SCENARIO TestThatNeedsFixing {
        LOG "This test is marked as needs fixing"
    }

    SCENARIO MultitaggedTest @smoke @regression @api @e2e {
        LOG "This test has multiple tags"
    }
}

# ============================================================
# SUMMARY: THE PAGEACTIONS PATTERN
# ============================================================
#
# 1. PAGE files contain ONLY:
#    - FIELD definitions (protected UI element selectors)
#    - Member variables (NUMBER, FLAG, TEXT for page state)
#    - NO actions - actions belong in PAGEACTIONS
#
#    Example:
#    PAGE LoginPage {
#        FIELD usernameInput = "Username"
#        FIELD passwordInput = "Password"
#        TEXT defaultUser = "guest"
#        NUMBER maxAttempts = 3
#        FLAG rememberEnabled = FALSE
#    }
#
# 2. PAGEACTIONS files contain ALL interactions:
#    - SETTERS: enterUsername WITH value { FILL usernameInput WITH value }
#    - ACTIONS: clickLogin { CLICK loginButton }
#    - COMPOSITE: login WITH user, pass { ... }
#    - GETTERS: isErrorVisible RETURNS FLAG { RETURN VISIBLE OF errorMessage }
#    - WAITERS: awaitLoginPage { WAIT FOR usernameInput }
#
# 3. FEATURES use PageActions, not Pages:
#    - USE LoginPageActions (not USE LoginPage)
#    - PERFORM LoginPageActions.login WITH "user", "pass"
#
# 4. ASSERTIONS belong in SCENARIOS only:
#    - PageActions return data via getters
#    - Scenarios call getters and perform VERIFY
#
#    Example:
#    FLAG hasError = PERFORM LoginPageActions.isErrorVisible
#    VERIFY hasError IS TRUE
#
# Benefits:
#    - Encapsulation: Selector changes only affect Page files
#    - Maintainability: Actions defined once in PageActions
#    - Readability: Tests read like user stories
#    - Testability: Clear separation of concerns
# ============================================================
