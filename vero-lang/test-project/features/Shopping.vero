# E-Commerce Shopping Feature Tests

FEATURE Shopping {
    USE ProductPage
    USE CartPage
    USE CheckoutPage

    BEFORE EACH {
        OPEN "https://shop.example.com/products/laptop"
    }

    SCENARIO UserCanAddProductToCart @smoke {
        VERIFY ProductPage.productTitle IS VISIBLE
        VERIFY ProductPage.addToCartBtn IS ENABLED
        PERFORM ProductPage.addToCart
        WAIT 500 MILLISECONDS
        VERIFY ProductPage.cartBadge IS VISIBLE
    }

    SCENARIO UserCanAddMultipleQuantities @regression {
        PERFORM ProductPage.addToCartWithQuantity WITH "3"
        WAIT 1 SECONDS
        VERIFY ProductPage.cartBadge IS VISIBLE
        LOG "Added 3 items to cart"
    }

    SCENARIO UserCanCompleteCheckout @smoke @e2e {
        PERFORM ProductPage.addToCart
        OPEN "https://shop.example.com/cart"
        VERIFY CartPage.cartItems IS VISIBLE
        VERIFY CartPage.cartTotal IS NOT EMPTY
        PERFORM CartPage.proceedToCheckout
        PERFORM CheckoutPage.fillShippingInfo WITH "buyer@test.com", "123 Main St", "New York", "10001"
        PERFORM CheckoutPage.fillPaymentInfo WITH "4111111111111111", "12/25", "123"
        PERFORM CheckoutPage.placeOrder
        WAIT 3 SECONDS
        VERIFY CheckoutPage.orderConfirmation IS VISIBLE
        TAKE SCREENSHOT "order_complete.png"
    }

    SCENARIO PromoCodeAppliesDiscount @regression {
        PERFORM ProductPage.addToCart
        OPEN "https://shop.example.com/cart"
        PERFORM CartPage.applyPromoCode WITH "SAVE20"
        WAIT 1 SECONDS
        VERIFY CartPage.promoSuccessMsg IS VISIBLE
        VERIFY CartPage.promoErrorMsg IS HIDDEN
    }

    SCENARIO InvalidPromoCodeShowsError @negative {
        PERFORM ProductPage.addToCart
        OPEN "https://shop.example.com/cart"
        PERFORM CartPage.applyPromoCode WITH "INVALIDCODE"
        VERIFY CartPage.promoErrorMsg IS VISIBLE
        VERIFY CartPage.promoSuccessMsg IS NOT VISIBLE
    }

    SCENARIO EmptyCartDisplaysMessage @edge {
        OPEN "https://shop.example.com/cart"
        VERIFY CartPage.emptyCartMessage IS VISIBLE
        VERIFY CartPage.checkoutBtn IS DISABLED
    }
}
